REPORT  Z1208PROG34.
*TYPE-POOLS VRM.

*PARAMETERS P_COURSE(20) TYPE C AS LISTBOX.. "SYNTAX ERROR

DATA : T_VALUES TYPE TABLE OF VRM_VALUE,
      WA_VALUE TYPE VRM_VALUE.

PARAMETERS P_COURSE(20) TYPE C AS LISTBOX VISIBLE LENGTH 20.

SELECTION-SCREEN SKIP .

SELECTION-SCREEN PUSHBUTTON 8(20) B1 USER-COMMAND FC1.

INITIALIZATION.
B1 = 'IDENTIFY'.
PERFORM DROPDOWNLIST.
IF T_VALUES IS NOT INITIAL.
  PERFORM DISPLAYDROPDOWN.
  ENDIF.

  AT SELECTION-SCREEN.
    CASE SY-UCOMM.
      WHEN 'FC1'.
        IF P_COURSE = 'K1'.
          MESSAGE ' CORE ABAP IS SELECTED' TYPE 'I'.
          ELSEIF P_COURSE = 'K2'.
                 MESSAGE ' OOPS ABAP IS SELECTED' TYPE 'I'.
            ELSEIF P_COURSE = 'K3'.
                   MESSAGE ' CROSS APPS IS SELECTED' TYPE 'I'.
              ELSE.
                     MESSAGE ' NONE IS SELECTED' TYPE 'I'.

                ENDIF.

                ENDCASE.



FORM DROPDOWNLIST.
  CLEAR WA_VALUE.
  WA_VALUE-KEY = 'K1'.
  WA_VALUE-TEXT = 'CORE ABAP'.
  APPEND WA_VALUE TO T_VALUES.

  CLEAR WA_VALUE.
  WA_VALUE-KEY = 'K2'.
  WA_VALUE-TEXT = 'OOPS ABAP'.
  APPEND WA_VALUE TO T_VALUES.

  CLEAR WA_VALUE.
  WA_VALUE-KEY = 'K3'.
  WA_VALUE-TEXT = 'CROSS APPS'.
  APPEND WA_VALUE TO T_VALUES.

  ENDFORM.


  FORM DISPLAYDROPDOWN.
    CALL FUNCTION 'VRM_SET_VALUES'
      EXPORTING
        ID                    = 'P_COURSE'
        VALUES                = T_VALUES
     EXCEPTIONS
       ID_ILLEGAL_NAME       = 1
       OTHERS                = 2
              .
IF SY-SUBRC EQ 1.
  MESSAGE 'ILLEGAL DRP DOWN LIST BOX NAME' TYPE 'I'.
  ELSEIF SY-SUBRC EQ 2.
    MESSAGE 'UNKNOWN ERROR' TYPE 'I'.
    ENDIF.


ENDFORM.